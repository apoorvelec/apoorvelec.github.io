<html>
    <style>
    </style>
    <body><div id="root"></div></body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>
    <script type="text/babel">
        class Cell extends React.Component {
            
            constructor(props) {
                super(props);
                this.state = { id:props.id, i: props.i, j:props.j, cellSize:props.cellSize, isSnakeCell:props.isSnakeCell};
            }
            
            render() {
                const style = {
                  width: this.state.cellSize,
                  height: this.state.cellSize,
                  backgroundColor: 'white',
                  outline: '1px solid rgba(144, 175, 175, 0.75)',
                  display: 'inline-block',
                };
                return (<div style={style}>{this.state.isSnakeCell?'S':''}</div>);
            }
        }

        class Grid extends React.Component {
            
            constructor(props) {
                super(props);
                this.state = { m: props.m, n:props.n, snake:['0:0', '0:1', '0:2'] };
            }

            deepCopyStringArray(arr) {
                return arr.map(str => String(str));
            }

            /**
                dir can be 'U', 'D', 'L', 'R'
            */
            moveSnakeByOne(dir) {
                console.log(dir);
                var head = this.state.snake[this.state.snake.length-1];
                var tail = this.state.snake[0];

                var headArr = head.split(':');
                var headi = headArr[0];
                var headj = headArr[1];

                console.log('headi:'+headi);
                console.log('headj:'+headj);

                var newHeadi = -1;
                var newHeadj = -1;
                switch(dir) {
                    case 'U':
                        // code block
                        if(headi-1>=0){
                            newHeadi = headi-1;
                            newHeadj = headj;
                        }else{
                            newHeadi = this.state.m-1;
                            newHeadj = headj;
                        }
                        break;
                    case 'D':
                        // code block
                        if(headi+1<this.state.m){
                            newHeadi = headi+1;
                            newHeadj = headj;
                        }else{
                            newHeadi = 0;
                            newHeadj = headj;
                        }
                        break;
                    case 'L':
                        // code block
                        if(headj-1>=0){
                            newHeadi = headi;
                            newHeadj = headj-1;
                        }else{
                            newHeadi = headi;
                            newHeadj = this.state.n-1;
                        }
                        break;
                    case 'R':
                        // code block
                        if(headj+1<this.state.n){
                            newHeadi = headi;
                            newHeadj = headj+1;
                        }else{
                            newHeadi = headi;
                            newHeadj = 0;
                        }
                        break;
                    default:
                        // code block
                        throw new Error('Invalid dir:'+dir);
                }

                console.log('newHeadi:'+newHeadi);
                console.log('newHeadj:'+newHeadj);

                var snakeDeepCopy = this.deepCopyStringArray(this.state.snake);
                snakeDeepCopy.push(newHeadi+':'+newHeadj);
                snakeDeepCopy.shift();
                console.log(snakeDeepCopy);
                this.setState({
                    ...this.state,
                    snake: snakeDeepCopy
                });

                console.log(this.state);
            }
            
            render() {
                const style = {
                  display: 'grid',
                  gridTemplateColumns: 'repeat('+this.state.n+', 0fr)',
                  gap: '0px',
                };
            
                var board = [];
                for(var i=0;i<this.state.m;i++){
                    var row = [];
                    for(var j=0;j<this.state.n;j++){
                        row.push('#');
                    }
                    board.push(row);
                }
        
                return (
                    <div>
                  <div style={style}>
                    {board.map((row, rowNum) => (
                      <div className="row">
                       {row.map((elem, colNum) => (<Cell key={rowNum+':'+colNum} id={rowNum+':'+colNum} i={rowNum} j={colNum} cellSize={'50px'} isSnakeCell={this.state.snake.includes(rowNum+':'+colNum)}></Cell>))}
                      </div>
                    ))}
                  </div>
                  <button onClick={() => this.moveSnakeByOne('R')}>
                    MoveSnake
                  </button>
                    </div>
                );
            }
        }
        ReactDOM.render(
            <Grid m={10} n={10}/>,
            document.getElementById('root')
        );
    </script>
</html>
